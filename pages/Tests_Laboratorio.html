<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestor de Plantillas</title>
    <link rel="stylesheet" href="index_lab.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
</script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=ABeeZee:ital@0;1&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=League+Spartan:wght@100..900&family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Ubuntu:ital,wght@0,300;0,400;0,500;0,700;1,300;1,400;1,500;1,700&display=swap" rel="stylesheet">
</head>
<body>
<script>
// Autollenado para Pruebas Rápidas
document.addEventListener('DOMContentLoaded', function(){
  try {
    const p = new URLSearchParams(location.search);
    const setVal = (id, v) => { const el = document.getElementById(id); if (el && v) el.value = v; };
    setVal('mascotaNombre', p.get('mascotaNombre'));
    setVal('propietarioNombre', p.get('propietarioNombre'));
    setVal('propietarioCedula', p.get('propietarioCedula'));
    setVal('propietarioTelefono', p.get('propietarioTelefono'));
    setVal('propietarioEmail', p.get('propietarioEmail'));
    setVal('nombreMedico', p.get('nombreMedico'));
    setVal('propietarioFecha', p.get('propietarioFecha'));
    setVal('mascotaRaza', p.get('mascotaRaza'));
    setVal('mascotaEdad', p.get('mascotaEdad'));
    setVal('mascotaPeso', p.get('mascotaPeso'));
    
    // Verificar el mensaje del médico después del autollenado
    const medico = p.get('nombreMedico');
    if (medico) {
      setTimeout(() => {
        verificarMedico();
      }, 100);
    }
  } catch(e){}
});
</script>
    <!-- Controles para selección de sexo y especie -->
    <div class="controls">
        <label for="sexoSelector">Selecciona el sexo:</label>
        <select id="sexoSelector" onchange="actualizarSexoEnPlantilla(),actualizarValoresReferencia()">
            <option value="Seleccionar" selected>-- Seleccionar --</option>
            <option value="Macho">Macho</option>
            <option value="Hembra">Hembra</option>
        </select>
        <label for="especieSelector">Selecciona la especie:</label>
        <select id="especieSelector" onchange="actualizarEspecieEnPlantilla(),actualizarValoresReferencia()">
            <option value="Seleccionar" selected>-- Seleccionar --</option>
            <option value="Canino">Canino</option>
            <option value="Felino">Felino</option>
            <option value="Lagomorfo">Lagomorfo</option>
            <option value="Cuilo">Cuilo</option>
        </select>
    </div>
    
    <!-- Selector de plantillas -->
    <div class="controls">
        <label for="templateSelector">Selecciona la plantilla:</label>
        <select id="templateSelector" onchange="mostrarPlantillaSeleccionada()">
            <option value="">-- Seleccionar --</option>
            <option value="template_4dx">4DX Idexx Elisa</option>
            <option value="template_caniV4">CaniV4</option>
            <option value="template_cpl">CPL Vcheck</option>
            <option value="template_cpv_ccv">CPV+CCV VCHECK</option>
            <option value="template_distemperVcheck">Distemper Vcheck</option>
            <option value="template_distemper">Distemper</option>
            <option value="template_ehrlichia_anaplasma">Ehrlichia - Anaplasma</option>
            <option value="template_ehrlichia_canis">Ehrlichia Canis</option>
            <option value="template_fpl">FPL Vcheck</option>
            <option value="template_giardia_crypto">Giardia - Crypto</option>
            <option value="template_parvo_giardia">Parvo - Giardia</option>
            <option value="template_parvo_corona_giardia">Parvo - Corona - Giardia</option>
            <option value="template_sdma">SDMA Vcheck</option>
            <option value="template_sida_leucemia">SIDA-LEUCEMIA</option>
            <option value="template_t4">T4 Vcheck</option>
            <option value="template_test_parvovirus">Test ParvoVirus</option>
            <option value="template_test_rivalta">Test Rivalta</option>
            <option value="template_tsh">TSH Vcheck</option>
        </select>
    </div>

    <!-- Contenedor principal con tamaño A4 -->
    <div class="a4-container">
        <!-- Datos básicos -->
        <div id="datosBasicos">
            <div class="header">
                <img src="empresa.jpg" alt="Logo de la Empresa" class="small-image">
                <h1>Laboratorio Clínico Veterinario</h1>
            </div>
            <h3 class="subheader">PRUEBAS RÁPIDAS</h3>
            <table>
                <thead>
                    <tr>
                        <th colspan="2">DATOS DE LA MASCOTA</th>
                        <th colspan="2">DATOS DEL PROPIETARIO</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Nombre</td>
                        <td><input type="text" id="mascotaNombre" onkeydown="moverFocoConFlechas(event, 'propietarioNombre', 'propietarioNombre', 'mascotaNombre', 'mascotaRaza')"></td>
                        <td>Nombre</td>
                        <td><input type="text" id="propietarioNombre"  onkeydown="moverFocoConFlechas(event, 'propietarioCedula', 'mascotaNombre', 'mascotaNombre', 'propietarioCedula')"></td>
                    </tr>
                    <tr>
                        <td>Raza</td>
                        <td><input type="text" id="mascotaRaza" list="razas"  onkeydown="moverFocoConFlechas(event, 'propietarioCedula', 'mascotaNombre', 'mascotaNombre', 'mascotaSexo')"></td>
                        <datalist id="razas"></datalist>
                        
                        <td>Cédula</td>
                        <td><input type="text" id="propietarioCedula"  onkeydown="moverFocoConFlechas(event, 'propietarioTelefono', 'mascotaRaza', 'propietarioNombre', 'propietarioTelefono')"></td>
                    </tr>
                    <tr>
                        <td>Sexo</td>
                        <td><input type="text" id="sexoEnPlantilla"></td>
                        <td>Teléfono</td>
                        <td><input type="text" id="propietarioTelefono" onkeydown="moverFocoConFlechas(event, 'propietarioCedula', 'mascotaSexo', 'propietarioCedula', 'propietarioEmail')"></td>
                    </tr>
                    <tr>
                        <td>Especie</td>
                        <td><input type="text" id="especieEnPlantilla"></td>
                        <td>Email</td>
                        <td><input type="text" id="propietarioEmail"  onkeydown="moverFocoConFlechas(event, 'mascotaEspecie', 'mascotaEspecie', 'propietarioTelefono', 'nombreMedico')"></td>
                    </tr>
                    <tr>
                        <td>Edad</td>
                        <td><input type="text" id="mascotaEdad" list="edades"  onkeydown="moverFocoConFlechas(event, 'nombreMedico', 'mascotaEspecie', 'mascotaEspecie', 'mascotaPeso')"></td>
                        <datalist id="edades">
                            <option value="1 mes">
                            <option value="2 meses">
                            <option value="3 meses">
                            <option value="4 meses">
                            <option value="5 meses">
                            <option value="6 meses">
                            <option value="7 meses">
                            <option value="8 meses">
                            <option value="9 meses">
                            <option value="10 meses">
                            <option value="11 meses">
                            <option value="12 meses">
                            <option value="1 año">
                            <option value="2 años">
                            <option value="3 años">
                            <option value="4 años">
                            <option value="5 años">
                            <option value="6 años">
                            <option value="7 años">
                            <option value="8 años">
                            <option value="9 años">
                            <option value="10 años">
                            <option value="11 años">
                            <option value="12 años">
                            <option value="13 años">
                            <option value="14 años">
                            <option value="15 años">
                            <option value="16 años">
                            <option value="17 años">
                            <option value="18 años">
                            <option value="19 años">
                            <option value="20 años">
                        </datalist>
                        <td>Médico</td>
                        <td>
                            <input type="text" id="nombreMedico" list="medicos" 
                                onkeydown="moverFocoConFlechas(event, 'propietarioFecha', 'mascotaEdad', 'propietarioEmail', 'propietarioFecha')" 
                                oninput="verificarMedico()">
                        </td>
                        <datalist id="medicos">
                            <option value="N.A">
                            <option value="Dr. Randall Azofeifa">
                            <option value="Dr. Luis Coto">
                            <option value="Dra. Daniela Sancho">
                            <option value="Dra. Sofia Carrillo">
                            <option value="Dra. Franciny Nuñez">
                            <option value="Dra. Lourdes Chacón">
                            <option value="Dra. Alejandra León">
                            <option value="Dra. Karla Quesada">
                            <option value="Dra. Kharen Moreno">
                            <option value="Dra. Karina Madrigal">
                            <option value="Dra. Natalia Alvarado">
                        </datalist>
                    </tr>
                    <tr>
                        <td>Peso</td>
                        <td><input type="text" id="mascotaPeso" list="pesos" onkeydown="moverFocoConFlechas(event, 'propietarioFecha', 'mascotaEdad', 'mascotaEdad', 'mascotaPeso')"></td>
                        <datalist id="pesos">
                            <option value="N.A">N.A</option><option value="0,1 kg">0,1 kg</option><option value="0,2 kg">0,2 kg</option><option value="0,3 kg">0,3 kg</option><option value="0,4 kg">0,4 kg</option>
                            <option value="0,5 kg">0,5 kg</option><option value="0,6 kg">0,6 kg</option><option value="0,7 kg">0,7 kg</option><option value="0,8 kg">0,8 kg</option><option value="0,9 kg">0,9 kg</option>
                            <option value="1,0 kg">1,0 kg</option><option value="1,1 kg">1,1 kg</option><option value="1,2 kg">1,2 kg</option><option value="1,3 kg">1,3 kg</option><option value="1,4 kg">1,4 kg</option>
                            <option value="1,5 kg">1,5 kg</option><option value="1,6 kg">1,6 kg</option><option value="1,7 kg">1,7 kg</option><option value="1,8 kg">1,8 kg</option><option value="1,9 kg">1,9 kg</option>
                            <option value="2,0 kg">2,0 kg</option><option value="2,1 kg">2,1 kg</option><option value="2,2 kg">2,2 kg</option><option value="2,3 kg">2,3 kg</option><option value="2,4 kg">2,4 kg</option>
                            <option value="2,5 kg">2,5 kg</option><option value="2,6 kg">2,6 kg</option><option value="2,7 kg">2,7 kg</option><option value="2,8 kg">2,8 kg</option><option value="2,9 kg">2,9 kg</option>
                            <option value="3,0 kg">3,0 kg</option><option value="3,1 kg">3,1 kg</option><option value="3,2 kg">3,2 kg</option><option value="3,3 kg">3,3 kg</option><option value="3,4 kg">3,4 kg</option>
                            <option value="3,5 kg">3,5 kg</option><option value="3,6 kg">3,6 kg</option><option value="3,7 kg">3,7 kg</option><option value="3,8 kg">3,8 kg</option><option value="3,9 kg">3,9 kg</option>
                            <option value="4,0 kg">4,0 kg</option><option value="4,1 kg">4,1 kg</option><option value="4,2 kg">4,2 kg</option><option value="4,3 kg">4,3 kg</option><option value="4,4 kg">4,4 kg</option>
                            <option value="4,5 kg">4,5 kg</option><option value="4,6 kg">4,6 kg</option><option value="4,7 kg">4,7 kg</option><option value="4,8 kg">4,8 kg</option><option value="4,9 kg">4,9 kg</option>
                            <option value="5,0 kg">5,0 kg</option><option value="5,1 kg">5,1 kg</option><option value="5,2 kg">5,2 kg</option><option value="5,3 kg">5,3 kg</option><option value="5,4 kg">5,4 kg</option>
                            <option value="5,5 kg">5,5 kg</option><option value="5,6 kg">5,6 kg</option><option value="5,7 kg">5,7 kg</option><option value="5,8 kg">5,8 kg</option><option value="5,9 kg">5,9 kg</option>
                            <option value="6,0 kg">6,0 kg</option><option value="6,1 kg">6,1 kg</option><option value="6,2 kg">6,2 kg</option><option value="6,3 kg">6,3 kg</option><option value="6,4 kg">6,4 kg</option>
                            <option value="6,5 kg">6,5 kg</option><option value="6,6 kg">6,6 kg</option><option value="6,7 kg">6,7 kg</option><option value="6,8 kg">6,8 kg</option><option value="6,9 kg">6,9 kg</option>
                            <option value="7,0 kg">7,0 kg</option><option value="7,1 kg">7,1 kg</option><option value="7,2 kg">7,2 kg</option><option value="7,3 kg">7,3 kg</option><option value="7,4 kg">7,4 kg</option>
                            <option value="7,5 kg">7,5 kg</option><option value="7,6 kg">7,6 kg</option><option value="7,7 kg">7,7 kg</option><option value="7,8 kg">7,8 kg</option><option value="7,9 kg">7,9 kg</option>
                            <option value="8,0 kg">8,0 kg</option><option value="8,1 kg">8,1 kg</option><option value="8,2 kg">8,2 kg</option><option value="8,3 kg">8,3 kg</option><option value="8,4 kg">8,4 kg</option>
                            <option value="8,5 kg">8,5 kg</option><option value="8,6 kg">8,6 kg</option><option value="8,7 kg">8,7 kg</option><option value="8,8 kg">8,8 kg</option><option value="8,9 kg">8,9 kg</option>
                            <option value="9,0 kg">9,0 kg</option><option value="9,1 kg">9,1 kg</option><option value="9,2 kg">9,2 kg</option><option value="9,3 kg">9,3 kg</option><option value="9,4 kg">9,4 kg</option>
                            <option value="9,5 kg">9,5 kg</option><option value="9,6 kg">9,6 kg</option><option value="9,7 kg">9,7 kg</option><option value="9,8 kg">9,8 kg</option><option value="9,9 kg">9,9 kg</option>
                            <option value="10,0 kg">10,0 kg</option><option value="10,1 kg">10,1 kg</option><option value="10,2 kg">10,2 kg</option><option value="10,3 kg">10,3 kg</option><option value="10,4 kg">10,4 kg</option>
                            <option value="10,5 kg">10,5 kg</option><option value="10,6 kg">10,6 kg</option><option value="10,7 kg">10,7 kg</option><option value="10,8 kg">10,8 kg</option><option value="10,9 kg">10,9 kg</option>
                            <option value="11,0 kg">11,0 kg</option><option value="11,1 kg">11,1 kg</option><option value="11,2 kg">11,2 kg</option><option value="11,3 kg">11,3 kg</option><option value="11,4 kg">11,4 kg</option>
                            <option value="11,5 kg">11,5 kg</option><option value="11,6 kg">11,6 kg</option><option value="11,7 kg">11,7 kg</option><option value="11,8 kg">11,8 kg</option><option value="11,9 kg">11,9 kg</option>
                            <option value="12,0 kg">12,0 kg</option> 
                        </datalist>
                        <td>Fecha</td>
                        <td><input type="date" id="propietarioFecha" class="date-input" onkeydown="moverFocoConFlechas(event, 'nombreMedico', 'mascotaPeso', 'nombreMedico', 'propietarioFecha')"></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div class="container plantilla" id="template_4dx">
            <h3 class="subheader">4DX Idexx Elisa</h3>
            <table>
                <thead>
                    <tr>
                        <th style="width: 70%;">ELISA 4DX IDEXX</th>
                        <th style="width: 30%;">Resultado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td colspan="2" style="background-color: #f2f2f2; font-weight: bold; text-align: left;">INMUNOLOGÍA</td>
                    </tr>
                    <tr>                        <td>Anaplasma phagocytofila</td>
                        <td>
                            <input type="text" style="width: 90%;" list="anaplasmaOptions_4dx">
                            <datalist id="anaplasmaOptions_4dx">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                    </tr>
                    <tr>
                        <td>Borrelia burgdorferi</td>
                        <td>
                            <input type="text" style="width: 90%;" list="borreliaOptions_4dx">
                            <datalist id="borreliaOptions_4dx">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                    </tr>
                    <tr>
                        <td>Dirofilaria immitis</td>
                        <td>
                            <input type="text" style="width: 90%;" list="dirofilariaOptions_4dx">
                            <datalist id="dirofilariaOptions_4dx">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                    </tr>
                    <tr>
                        <td>Ehrlichia canis/ewingii</td>
                        <td>
                            <input type="text" style="width: 90%;" list="ehrlichiaOptions_4dx">
                            <datalist id="ehrlichiaOptions_4dx">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" style="padding-top: 15px; padding-bottom: 15px; font-style: italic;">
                            Prueba interpretada a los 8 minutos exactos, según especificaciones del fabricante.
                        </td>
                    </tr>
                </tbody>
            </table>
            <br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
            </div>
            </div>
            </div>
        </div>
        </div>

        <div class="container plantilla" id="template_caniV4">
            <h3 class="subheader">CaniV4</h3>
            <table>
                <thead>
                    <tr>
                        <th>Matriz de Muestra:</th>
                        <th>Sangre Entera</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <tr>                        <td>Dirofilaria (HW A)</td>
                        <td>
                            <input type="text" style="width: 90%;" list="dirofilariaOptions_caniv4" onchange="formatResultSign(this)">
                            <datalist id="dirofilariaOptions_caniv4">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td class="sign-column">-</td>
                    </tr>
                    <tr>
                        <td>Ehrilichia Canis Ab</td>
                        <td>
                            <input type="text" style="width: 90%;" list="ehrlichiaOptions_caniv4" onchange="formatResultSign(this)">
                            <datalist id="ehrlichiaOptions_caniv4">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td class="sign-column">-</td>
                    </tr>
                    <tr>
                        <td>Borrelia (Lyme Ab)</td>
                        <td>
                            <input type="text" style="width: 90%;" list="borreliaOptions_caniv4" onchange="formatResultSign(this)">
                            <datalist id="borreliaOptions_caniv4">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td class="sign-column">-</td>
                    </tr>
                    <tr>
                        <td>Anaplasma Ab</td>
                        <td>
                            <input type="text" style="width: 90%;" list="anaplasmaOptions_caniv4" onchange="formatResultSign(this)">
                            <datalist id="anaplasmaOptions_caniv4">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td class="sign-column">-</td>
                    </tr>
                    <tr>
                        <td colspan="2" style="padding-top: 15px; padding-bottom: 25px; font-style: italic;">
                            Detección cualitativa del antígeno de Dirofilaria immitis, Anticuerpo de Ehrlichia canis<br>					
                            Anticuerpo de borrelia burgdorferi y Anticuerpo de Anaplasma phagocytophilum/anaplasma platys<br>				
                            leido e interpretado a los 15 minutos exactos  según especificaciones del fabricante.	
                            <td class="sign-column"></td>
                        </td>
                    </tr>
                </tbody>
            </table>
             <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
            <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                    <div>
                        <input type="file" id="imageUpload" accept="image/*" onchange="previewImage(event)" style="margin-bottom: 10px;">
                        <button type="button" onclick="document.getElementById('imageUpload').click()">Seleccionar imagen</button>
                    </div>
                    <div id="imagePreviewContainer" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                        <img id="imagePreview" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                        <span id="noImageText">Sin imagen</span>
                    </div>
                </div>
                <br><br>
                <div class="footer">
                    <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                    <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                    <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                    <p>Correo: laboratorio@vetsanmartin.com</p>
                </div>
        </div>

        <div class="container plantilla" id="template_cpl">
            <h3 class="subheader">CPL Vcheck</h3>
            <table>
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Resultado</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Muestra</td>
                        <td colspan="2">Suero</td>
                    </tr>
                    <tr>
                        <td>Control</td>
                        <td colspan="2">Valido</td>
                    </tr>
                    <tr>
                        <td>Interpretación</td>
                        <td colspan="2">
                            <input type="text" id="cplResultado" onblur="actualizarInterpretacionCPL()" style="width: 40%; margin-right: 10px;" placeholder="Valor en ng/ml">                            <input type="text" id="cplInterpretacion" style="width: 50%;" list="cplInterpretacionOptions">
                            <datalist id="cplInterpretacionOptions">
                                <option value="Normal">
                                <option value="Sospechoso">
                                <option value="Consistente con Pancreatitis">
                            </datalist>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <table style="margin-top: 15px;">
                <thead>
                    <tr>
                        <th colspan="3">Rangos de Referencia</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Normal</td>
                        <td>&lt;200</td>
                        <td>ng/ml</td>
                    </tr>
                    <tr>
                        <td>Sospechoso</td>
                        <td>200 a 400</td>
                        <td>ng/ml</td>
                    </tr>
                    <tr>
                        <td>Consistente con Pancreatitis</td>
                        <td>&gt;400</td>
                        <td>ng/ml</td>
                    </tr>
                </tbody>
            </table>
            <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                Detección in vitro para la medición cuantitativa de la concentración de lipasa específica canina<br>
                leido e interpretado a los 5 minutos exactos según especificaciones del fabricante.
            </p>
                    <br><br>
                    <div class="footer">
                        <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                        <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                        <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                        <p>Correo: laboratorio@vetsanmartin.com</p>
                    </div>
        </div>
    
        <div class="container plantilla" id="template_cpv_ccv">
            <h3 class="subheader">Test Ag CPV+CCV VCHECK</h3>
            <table>
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Resultado</th>
                        <th>Observación</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Muestra</td>
                        <td colspan="2">Hisopado</td>
                    </tr>
                    <tr>                        <td>Parvovirus Canino (CPV)</td>
                        <td>
                            <input type="text" style="width: 90%;" id="cpvResultado" list="cpvResultadoOptions" onchange="formatResultSignCPV(this)">
                            <datalist id="cpvResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td>Presencia de antígeno CPV</td>
                    </tr>
                    <tr>
                        <td>Control CPV</td>
                        <td>Válido</td>
                        <td>
                            COI=<input type="text" id="coiCPV"  style="width: 50px; text-align: center;"> CPV
                        </td>
                    </tr>
                    <tr>                        <td>Coronavirus Canino (CCV)</td>
                        <td>
                            <input type="text" style="width: 90%;" id="ccvResultado" list="ccvResultadoOptions" onchange="formatResultSignCCV(this)">
                            <datalist id="ccvResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td>Ausencia de antígeno CCV</td>
                    </tr>
                    <tr>
                        <td>Control CCV</td>
                        <td>Válido</td>
                        <td>
                            COI=<input type="text" id="coiCPV"  style="width: 50px; text-align: center;"> CPV
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                Detección cualitativa del antígeno Parvo virus canino y Corona virus canino en heces,<br>
                leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
            </p>
            
            <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                    <div>
                        <input type="file" id="imageUploadCPVCCV" accept="image/*" onchange="previewImageCPVCCV(event)" style="margin-bottom: 10px;">
                        <button type="button" onclick="document.getElementById('imageUploadCPVCCV').click()">Seleccionar imagen</button>
                    </div>
                    <div id="imagePreviewContainerCPVCCV" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                        <img id="imagePreviewCPVCCV" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                        <span id="noImageTextCPVCCV">Sin imagen</span>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
            </div>
        </div>
    
        <div class="container plantilla" id="template_distemperVcheck">
            <h3 class="subheader">Test Ag CDV V-Check</h3>
            <table>
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Resultado</th>
                        <th>Observación</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Muestra</td>
                        <td colspan="2">Hisopado</td>
                    </tr>
                    <tr>
                        <td>Control</td>
                        <td>Válido</td>
                        <td>
                            COI=<input type="text" id="coiCPV" style="width: 50px; text-align: center;"> CPV
                        </td>                    </tr>
                    <tr>
                        <td>Virus Distemper Canino (CDV)</td>
                        <td>
                            <input type="text" style="width: 90%;" id="cdvResultado" list="cdvResultadoOptions" onchange="formatResultSignCDV(this)">
                            <datalist id="cdvResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td id="cdvObservacion">Ausencia de antígeno CDV</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                Detección in vitro para la detección cualitativa del antígeno del virus del moquillo canino,<br>
                leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
            </p>
            <br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
                </div>
            </div>
        </div>
        
        <div class="container plantilla" id="template_distemper">
            <h3 class="subheader">Distemper</h3>
            <table>
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Resultado</th>
                        <th>Observación</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Muestra</td>
                        <td colspan="2">
                            <input type="text" style="width: 90%;" id="distemperMuestra" list="distemperMuestraOptions">
                            <datalist id="distemperMuestraOptions">
                                <option value="Plasma"></option>
                                <option value="Conjuntiva"></option>
                                <option value="Hisopado">
                                <option value="Suero">
                                <option value="Sangre">
                            </datalist>
                        </td>
                    </tr>
                    <tr>
                        <td>Control</td>
                        <td colspan="2">Válido</td>
                    </tr>
                    <tr>
                        <td>Virus Distemper Canino (CDV)</td>
                        <td>
                            <input type="text" style="width: 90%;" id="distemperResultado" list="distemperResultadoOptions" onchange="actualizarDistemperSigno(this)">
                            <datalist id="distemperResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td id="distemperSigno">(-)</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                Detección cualitativa del antígeno del virus del moquillo canino,<br>
                leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
            </p>
            
            <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                    <div>
                        <input type="file" id="imageUploadDistemperTest" accept="image/*" onchange="previewImageDistemperTest(event)" style="margin-bottom: 10px;">
                        <button type="button" onclick="document.getElementById('imageUploadDistemperTest').click()">Seleccionar imagen</button>
                    </div>
                    <div id="imagePreviewContainerDistemperTest" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                        <img id="imagePreviewDistemperTest" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                        <span id="noImageTextDistemperTest">Sin imagen</span>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
            </div>
        </div>
        <div class="container plantilla" id="template_ehrlichia_anaplasma">
            <h3 class="subheader">Test Ag Ehrlichia-Anaplasma</h3>
            <table>
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Resultado</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Muestra</td>
                        <td colspan="2">
                            <input type="text" style="width: 90%;" id="ehrlichia_anaplasmaMuestra" list="ehrlichiaAnaplasmaMuestraOptions">
                            <datalist id="ehrlichiaAnaplasmaMuestraOptions">
                                <option value="Suero">
                                <option value="Sangre">
                            </datalist>
                        </td>
                    </tr>
                    <tr>
                        <td>Control</td>
                        <td colspan="2">Válido</td>
                    </tr>
                    <tr>
                        <td>Ehrlichia Ab</td>
                        <td>
                            <input type="text" style="width: 90%;" id="ehrlichiaResultado" list="ehrlichiaResultadoOptions" onchange="actualizarEhrlichiaSigno(this)">
                            <datalist id="ehrlichiaResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td id="ehrlichiaSigno">(-)</td>
                    </tr>
                    <tr>
                        <td>Anaplasma Ab</td>
                        <td>
                            <input type="text" style="width: 90%;" id="anaplasmaResultado" list="anaplasmaResultadoOptions" onchange="actualizarAnaplasmaSigno(this)">
                            <datalist id="anaplasmaResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td id="anaplasmaSigno">(-)</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                Detección de anticuerpos de Anaplasma y Anticuerpos de Ehrlichia canis.<br>
                leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
            </p>
            
            <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                    <div>
                        <input type="file" id="imageUploadEhrlichiaAnaplasma" accept="image/*" onchange="previewImageEhrlichiaAnaplasma(event)" style="margin-bottom: 10px;">
                        <button type="button" onclick="document.getElementById('imageUploadEhrlichiaAnaplasma').click()">Seleccionar imagen</button>
                    </div>
                    <div id="imagePreviewContainerEhrlichiaAnaplasma" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                        <img id="imagePreviewEhrlichiaAnaplasma" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                        <span id="noImageTextEhrlichiaAnaplasma">Sin imagen</span>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
            </div>
        </div>
    </div>
    <div class="container plantilla" id="template_ehrlichia_canis">
        <h3 class="subheader">Inmunocromatografía Ehrlichia canis</h3>
        <table>
            <thead>
                <tr>
                    <th>Parámetro</th>
                    <th>Resultado</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Matriz de Muestra</td>
                    <td colspan="2">Sangre Entera</td>
                </tr>
                <tr>
                    <td>E. Canis</td>
                    <td>                        <input type="text" style="width: 90%;" id="ehrlichiaCanisResultado" list="ehrlichiaCanisResultadoOptions" onchange="actualizarEhrlichiaCanisSigno(this)">
                        <datalist id="ehrlichiaCanisResultadoOptions">
                            <option value="Negativo">
                            <option value="Positivo">
                        </datalist>
                    </td>
                    <td id="ehrlichiaCanisSigno">(+)</td>
                </tr>
            </tbody>
        </table>
        
        <p style="margin-top: 20px; font-style: italic; font-size: 12px">
            Detección cualitativa de anticuerpo contra ehrlichia canis,<br>
            leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
        </p>
        
        <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
            <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                <div>
                    <input type="file" id="imageUploadEhrlichiaCanis" accept="image/*" onchange="previewImageEhrlichiaCanis(event)" style="margin-bottom: 10px;">
                    <button type="button" onclick="document.getElementById('imageUploadEhrlichiaCanis').click()">Seleccionar imagen</button>
                </div>
                <div id="imagePreviewContainerEhrlichiaCanis" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                    <img id="imagePreviewEhrlichiaCanis" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                    <span id="noImageTextEhrlichiaCanis">Sin imagen</span>
                </div>
            </div>
        </div>
        <br><br>
        <div class="footer">
            <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
            <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
            <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
            <p>Correo: laboratorio@vetsanmartin.com</p>
        </div>
    </div>
    <div class="container plantilla" id="template_fpl">
        <h3 class="subheader">FPL Vcheck</h3>
        <table>
            <thead>
                <tr>
                    <th>Parámetro</th>
                    <th>Resultado</th>
                    <th>Valor de referencia</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Muestra</td>
                    <td colspan="2">Suero</td>
                </tr>
                <tr>
                    <td>Control</td>
                    <td colspan="2">Valido</td>
                </tr>
                <tr>
                    <td>Interpretación</td>
                    <td colspan="2">
                        <input type="text" id="fplResultado" onblur="actualizarInterpretacionFPL()" style="width: 40%; margin-right: 10px;" placeholder="Valor en ng/ml">
                        <select id="fplInterpretacion" style="width: 50%;">
                            <option value="Normal">Normal</option>
                            <option value="Sospechoso">Sospechoso</option>
                            <option value="Consistente con Pancreatitis">Consistente con Pancreatitis</option>
                        </select>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <table style="margin-top: 15px;">
            <thead>
                <tr>
                    <th colspan="3">Rangos de Referencia</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Normal</td>
                    <td>&lt;3,5</td>
                    <td>ng/ml</td>
                </tr>
                <tr>
                    <td>Sospechoso</td>
                    <td>3,6 a 5,3</td>
                    <td>ng/ml</td>
                </tr>
                <tr>
                    <td>Consistente con Pancreatitis</td>
                    <td>&gt;5,4</td>
                    <td>ng/ml</td>
                </tr>
            </tbody>
        </table>
        
        <p style="margin-top: 20px; font-style: italic; font-size: 12px">
            Detección in vitro para la medicón cuantitativa de la concentración de lipasa específica del páncreas felino.<br>
            leido e interpretado a los 15 minutos exactos según especificaciones del fabricante.
        </p>
        <br><br>
        <div class="footer">
            <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
            <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
            <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
            <p>Correo: laboratorio@vetsanmartin.com</p>
        </div>
    </div>
    <div class="container plantilla" id="template_giardia_crypto">
        <h3 class="subheader">Test Giardia / Crypto</h3>
        <table>
            <thead>
                <tr>
                    <th>Parámetro</th>
                    <th>Resultado</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Muestra</td>
                    <td colspan="2">Hisopo de Heces</td>
                </tr>
                <tr>
                    <td>Control</td>
                    <td colspan="2">Válido</td>
                </tr>
                <tr>
                    <td>Giardia</td>
                    <td>                        <input type="text" style="width: 90%;" id="giardiaResultado" list="giardiaResultadoOptions" onchange="actualizarGiardiaSigno(this)">
                        <datalist id="giardiaResultadoOptions">
                            <option value="Negativo">
                            <option value="Positivo">
                        </datalist>
                    </td>
                    <td id="giardiaSigno">(+)</td>
                </tr>
                <tr>
                    <td>Cryptosporidium</td>
                    <td>                        <input type="text" style="width: 90%;" id="cryptoResultado" list="cryptoResultadoOptions" onchange="actualizarCryptoSigno(this)">
                        <datalist id="cryptoResultadoOptions">
                            <option value="Negativo">
                            <option value="Positivo">
                        </datalist>
                    </td>
                    <td id="cryptoSigno">(+)</td>
                </tr>
            </tbody>
        </table>
        
        <p style="margin-top: 20px; font-style: italic; font-size: 12px">
            Detección cualitativa inmunocromatográfica de giardia y crypto,<br>
            leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
        </p>
        
        <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
            <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                <div>
                    <input type="file" id="imageUploadGiardiaCrypto" accept="image/*" onchange="previewImageGiardiaCrypto(event)" style="margin-bottom: 10px;">
                    <button type="button" onclick="document.getElementById('imageUploadGiardiaCrypto').click()">Seleccionar imagen</button>
                </div>
                <div id="imagePreviewContainerGiardiaCrypto" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                    <img id="imagePreviewGiardiaCrypto" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                    <span id="noImageTextGiardiaCrypto">Sin imagen</span>
                </div>
            </div>
        </div>
        <br><br>
        <div class="footer">
            <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
            <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
            <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
            <p>Correo: laboratorio@vetsanmartin.com</p>
        </div>
    </div>

    <div class="container plantilla" id="template_parvo_giardia">
        <h3 class="subheader">Test CPV / Giardia</h3>
        <table>
            <thead>
                <tr>
                    <th>Parámetro</th>
                    <th>Resultado</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Muestra</td>
                    <td colspan="2">Hisopo de Heces</td>
                </tr>
                <tr>
                    <td>Control</td>
                    <td colspan="2">Válido</td>
                </tr>
                <tr>
                    <td>Parvovirus Canino (CPV)</td>
                    <td>
                        <select style="width: 90%;" id="parvoGiardiaResultadoCPV" onchange="actualizarParvoGiardiaSignoCPV(this)">
                            <option value="Negativo">Negativo</option>
                            <option value="Positivo" selected>Positivo</option>
                        </select>
                    </td>
                    <td id="parvoGiardiaSignoCPV">(+)</td>
                </tr>
                <tr>
                    <td>Giardia</td>
                    <td>
                        <select style="width: 90%;" id="parvoGiardiaResultadoGiardia" onchange="actualizarParvoGiardiaSignoGiardia(this)">
                            <option value="Negativo">Negativo</option>
                            <option value="Positivo" selected>Positivo</option>
                        </select>
                    </td>
                    <td id="parvoGiardiaSignoGiardia">(+)</td>
                </tr>
            </tbody>
        </table>
        
        <p style="margin-top: 20px; font-style: italic; font-size: 12px">
            Detección de antígeno de parvo virus y giardia,<br>
            leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
        </p>
        
        <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
            <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                <div>
                    <input type="file" id="imageUploadParvoGiardia" accept="image/*" onchange="previewImageParvoGiardia(event)" style="margin-bottom: 10px;">
                    <button type="button" onclick="document.getElementById('imageUploadParvoGiardia').click()">Seleccionar imagen</button>
                </div>
                <div id="imagePreviewContainerParvoGiardia" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                    <img id="imagePreviewParvoGiardia" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                    <span id="noImageTextParvoGiardia">Sin imagen</span>
                </div>
            </div>
        </div>
        <br><br>
        <div class="footer">
            <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
            <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
            <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
            <p>Correo: laboratorio@vetsanmartin.com</p>
        </div>
    </div>
    <div class="container plantilla" id="template_parvo_corona_giardia">
        <h3 class="subheader">Inmunocromatografía CPV/Giardia/CCV</h3>
        <table>
            <thead>
                <tr>
                    <th>Parámetro</th>
                    <th>Resultado</th>
                    <th>Valor</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Muestra</td>
                    <td colspan="2">Hisopo de heces</td>
                </tr>
                <tr>
                    <td>Parvovirus Canino (CPV)</td>
                    <td>                        <input type="text" style="width: 90%;" id="tripleResultadoCPV" list="tripleResultadoCPVOptions" onchange="actualizarTripleSignoCPV(this)">
                        <datalist id="tripleResultadoCPVOptions">
                            <option value="Negativo">
                            <option value="Positivo">
                        </datalist>
                    </td>
                    <td id="tripleSignoCPV">(-)</td>
                </tr>
                <tr>
                    <td>Giardia</td>
                    <td>                        <input type="text" style="width: 90%;" id="tripleResultadoGiardia" list="tripleResultadoGiardiaOptions" onchange="actualizarTripleSignoGiardia(this)">
                        <datalist id="tripleResultadoGiardiaOptions">
                            <option value="Negativo">
                            <option value="Positivo">
                        </datalist>
                    </td>
                    <td id="tripleSignoGiardia">(-)</td>
                </tr>
                <tr>
                    <td>Coronavirus Canino (CCV)</td>
                    <td>                        <input type="text" style="width: 90%;" id="tripleResultadoCCV" list="tripleResultadoCCVOptions" onchange="actualizarTripleSignoCCV(this)">
                        <datalist id="tripleResultadoCCVOptions">
                            <option value="Negativo">
                            <option value="Positivo">
                        </datalist>
                    </td>
                    <td id="tripleSignoCCV">(-)</td>
                </tr>
            </tbody>
        </table>
        
        <p style="margin-top: 20px; font-style: italic; font-size: 12px">
            Detección del antígeno de Parvovirus, Coronavirus y Giardia Canino,<br>
            leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
        </p>
        
        <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
            <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                <div>
                    <input type="file" id="imageUploadTripleTest" accept="image/*" onchange="previewImageTripleTest(event)" style="margin-bottom: 10px;">
                    <button type="button" onclick="document.getElementById('imageUploadTripleTest').click()">Seleccionar imagen</button>
                </div>
                <div id="imagePreviewContainerTripleTest" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                    <img id="imagePreviewTripleTest" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                    <span id="noImageTextTripleTest">Sin imagen</span>
                </div>
            </div>
        </div>
        <br><br>
        <div class="footer">
            <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
            <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
            <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
            <p>Correo: laboratorio@vetsanmartin.com</p>
        </div>
    </div>
    <div class="container plantilla" id="template_sdma">
        <h3 class="subheader">SDMA Vcheck</h3>
        <table>
            <thead>
                <tr>
                    <th>Parámetro</th>
                    <th>Resultado</th>
                    <th>Valor de referencia</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Muestra</td>
                    <td colspan="2">Suero Heparinizado</td>
                </tr>
                <tr>
                    <td>Control</td>
                    <td colspan="2">Valido</td>
                </tr>
                <tr>
                    <td>Interpretación</td>
                    <td colspan="2">
                        <input type="text" id="sdmaResultado" onblur="actualizarInterpretacionSDMA()" style="width: 40%; margin-right: 10px;" placeholder="Valor en ug/dl">
                        <select id="sdmaInterpretacion" style="width: 50%;">
                            <option value="Normal">Normal</option>
                            <option value="Sospechoso">Sospechoso</option>
                            <option value="Enfermedad Renal Probable">Enfermedad Renal Probable</option>
                        </select>
                    </td>
                </tr>
            </tbody>
        </table>
        
        <table style="margin-top: 15px;">
            <thead>
                <tr>
                    <th colspan="3">Rangos de Referencia</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Normal</td>
                    <td>&lt;14</td>
                    <td>ug/dl</td>
                </tr>
                <tr>
                    <td>Sospechoso</td>
                    <td>14.1 a 19.9</td>
                    <td>ug/dl</td>
                </tr>
                <tr>
                    <td>Enfermedad Renal Probable</td>
                    <td>&gt;20</td>
                    <td>ug/dl</td>
                </tr>
            </tbody>
        </table>
        
        <p style="margin-top: 20px; font-style: italic; font-size: 12px">
            Detección in vitro para la medición cuantitativa de dimetilarginina simétrica.<br>
            leido e interpretado según especificaciones del fabricante.
        </p>
        <br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
            </div>
            </div>
        </div>
        <div class="container plantilla" id="template_sida_leucemia">
            <h3 class="subheader">Inmunocromatografía FIV/FeLV</h3>
            <table>
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Resultado</th>
                        <th>Valor</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Muestra</td>
                        <td colspan="2">Sangre Entera</td>
                    </tr>
                    <tr>
                        <td>Sida Felino (FIV)</td>
                        <td>                            <input type="text" style="width: 90%;" id="fivResultado" list="fivResultadoOptions" onchange="actualizarFIVSigno(this)">
                            <datalist id="fivResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td id="fivSigno">(-)</td>
                    </tr>
                    <tr>
                        <td>Leucemia Felina (FeLV)</td>
                        <td>                            <input type="text" style="width: 90%;" id="felvResultado" list="felvResultadoOptions" onchange="actualizarFeLVSigno(this)">
                            <datalist id="felvResultadoOptions">
                                <option value="Negativo">
                                <option value="Positivo">
                            </datalist>
                        </td>
                        <td id="felvSigno">(-)</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                Detección simultánea del anticuerpo del Sida Felino y del Antígeno de la Leucemia Felina,<br>
                leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
            </p>
            
            <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
                <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                    <div>
                        <input type="file" id="imageUploadFIVFeLV" accept="image/*" onchange="previewImageFIVFeLV(event)" style="margin-bottom: 10px;">
                        <button type="button" onclick="document.getElementById('imageUploadFIVFeLV').click()">Seleccionar imagen</button>
                    </div>
                    <div id="imagePreviewContainerFIVFeLV" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                        <img id="imagePreviewFIVFeLV" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                        <span id="noImageTextFIVFeLV">Sin imagen</span>
                    </div>
                </div>
            </div>
            <br><br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
            </div>
        </div>
        <div class="container plantilla" id="template_t4">
            <h3 class="subheader">T4 Vcheck</h3>
            <table>
                <thead>
                    <tr>
                        <th>Parámetro</th>
                        <th>Resultado</th>
                        <th>Valor de referencia</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Muestra</td>
                        <td colspan="2">Suero</td>
                    </tr>
                    <tr>
                        <td>Control</td>
                        <td colspan="2">Valido</td>
                    </tr>
                    <tr>
                        <td>Interpretación</td>
                        <td colspan="2">
                            <input type="text" id="t4Resultado" onblur="actualizarInterpretacionT4()" style="width: 40%; margin-right: 10px;" placeholder="Valor en ug/dl">
                            <select id="t4Interpretacion" style="width: 50%;">
                                <option value="Bajo">Bajo</option>
                                <option value="Bajo Normal" selected>Bajo Normal</option>
                                <option value="Normal">Normal</option>
                                <option value="Alto">Alto</option>
                            </select>
                        </td>
                    </tr>
                </tbody>
            </table>
            
            <table style="margin-top: 15px;">
                <thead>
                    <tr>
                        <th colspan="3">Rangos de Referencia</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Bajo</td>
                        <td>&lt;1,0</td>
                        <td>ug/dl</td>
                    </tr>
                    <tr>
                        <td>Bajo Normal</td>
                        <td>1,0 a 2,0</td>
                        <td>ug/dl</td>
                    </tr>
                    <tr>
                        <td>Normal</td>
                        <td>1,0 a 4,0</td>
                        <td>ug/dl</td>
                    </tr>
                    <tr>
                        <td>Alto</td>
                        <td>&gt;4,0</td>
                        <td>ug/dl</td>
                    </tr>
                </tbody>
            </table>
            
            <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                Detección in vitro para la medición cuantitativa de tiroxina total (T4) en suero o plasma.<br>
                leido e interpretado según especificaciones del fabricante.
            </p>
            <br>
            <div class="footer">
                <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                <p>Correo: laboratorio@vetsanmartin.com</p>
                    </div>
                </div>
            </div>
            <div class="container plantilla" id="template_test_parvovirus">
                <h3 class="subheader">Test Parvovirus Canino</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Parámetro</th>
                            <th>Resultado</th>
                            <th>Valor</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Matriz de Muestra</td>
                            <td colspan="2">Hisopo de Heces Canina</td>
                        </tr>
                        <tr>
                            <td>Control</td>
                            <td colspan="2">Válido</td>
                        </tr>
                        <tr>
                            <td>Parvovirus Canino (CPV)</td>
                            <td>                                <input type="text" style="width: 90%;" id="cpvSoloResultado" list="cpvSoloResultadoOptions" onchange="actualizarCpvSoloSigno(this)">
                                <datalist id="cpvSoloResultadoOptions">
                                    <option value="Negativo">
                                    <option value="Positivo">
                                </datalist>
                            </td>
                            <td id="cpvSoloSigno">(-)</td>
                        </tr>
                        <tr>
                            <td>Interpretación</td>
                            <td colspan="2" id="cpvSoloInterpretacion">Ausencia de Antígeno de CPV</td>
                        </tr>
                    </tbody>
                </table>
                
                <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                    Detección cualitativa del antígeno de parvovirus canino en heces,<br>
                    leido e interpretado a los 10 minutos exactos según especificaciones del fabricante.
                </p>
                
                <div class="image-upload-container" style="margin-top: 20px; text-align: center;">
                    <div style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                        <div>
                            <input type="file" id="imageUploadCPVSolo" accept="image/*" onchange="previewImageCPVSolo(event)" style="margin-bottom: 10px;">
                            <button type="button" onclick                            <button type="button" onclick="document.getElementById('imageUploadCPVSolo').click()">Seleccionar imagen</button>
                        </div>
                        <div id="imagePreviewContainerCPVSolo" style="width: 400px; height: 300px; border: 1px dashed #ccc; display: flex; justify-content: center; align-items: center; margin: 0 auto;">
                            <img id="imagePreviewCPVSolo" src="#" alt="Vista previa" style="max-width: 100%; max-height: 100%; display: none;">
                            <span id="noImageTextCPVSolo">Sin imagen</span>
                        </div>
                    </div>
                </div>
                <br><br>
                <div class="footer">
                    <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                    <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                    <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                    <p>Correo: laboratorio@vetsanmartin.com</p>
                </div>
            </div>
            <div class="container plantilla" id="template_test_rivalta">
                <h3 class="subheader">Microbiología Clínica</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Parámetro</th>
                            <th colspan="2">Resultado</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Matriz de muestra</td>
                            <td colspan="2">
                                <input type="text" style="width: 90%;"></td>
                            </td>
                        </tr>
                        <tr>
                            <td>Color</td>
                            <td colspan="2"><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Turbidez</td>
                            <td colspan="2"><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Clasificación</td>
                            <td colspan="2"><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Test de Rivalta</td>
                            <td colspan="2">                                <input type="text" style="width: 90%;" id="rivaltaResultado" list="rivaltaResultadoOptions">
                                <datalist id="rivaltaResultadoOptions">
                                    <option value="Negativo">
                                    <option value="Positivo">
                                </datalist>
                            </td>
                        </tr>
                        <tr>
                            <td>Directo</td>
                            <td colspan="2"><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Diff Quick</td>
                            <td colspan="2"><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Gram</td>
                            <td colspan="2"><input type="text" style="width: 90%;"></td>
                        </tr>
                    </tbody>
                </table>
                
                <table style="margin-top: 15px;">
                    <thead>
                        <tr>
                            <th colspan="3">Tira reactiva</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Densidad</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>pH</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Proteina</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Glucosa</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Leucocitos</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Eritrocitos</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Nitritos</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Cetonas</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Bilirrubina</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                        <tr>
                            <td>Urobilinógeno</td>
                            <td><input type="text" style="width: 90%;"></td>
                        </tr>
                    </tbody>
                </table>
                
                <table style="margin-top: 15px;">
                    <thead>
                        <tr>
                            <th>Interpretación Microbiológica</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>
                                <textarea id="interpretacionMicrobiologica" style="width: 100%; height: 80px; resize: none;">La prueba de Rivalta se determina negativo.</textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <br><br>
                <div class="footer">
                    <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                    <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                    <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                    <p>Correo: laboratorio@vetsanmartin.com</p>
                </div>
                    </div>
                </div>
            </div>
            <div class="container plantilla" id="template_tsh">
                <h3 class="subheader">TSH Vcheck</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Parámetro</th>
                            <th>Resultado</th>
                            <th>Valor de referencia</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Muestra</td>
                            <td colspan="2">Suero</td>
                        </tr>
                        <tr>
                            <td>Control</td>
                            <td colspan="2">Valido</td>
                        </tr>
                        <tr>
                            <td>Interpretación</td>
                            <td colspan="2">
                                <input type="text" id="tshResultado" onblur="actualizarInterpretacionTSH()" style="width: 40%; margin-right: 10px;" placeholder="Valor en ng/ml">
                                <select id="tshInterpretacion" style="width: 50%;">
                                    <option value="Normal" selected>Normal</option>
                                    <option value="Alto">Alto</option>
                                </select>
                            </td>
                        </tr>
                    </tbody>
                </table>
                <table style="margin-top: 15px;">
                    <thead>
                        <tr>
                            <th colspan="3">Rangos de Referencia</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Normal</td>
                            <td>&lt;0,5</td>
                            <td>ng/ml</td>
                        </tr>
                        <tr>
                            <td>Alto</td>
                            <td>&gt;0,5</td>
                            <td>ng/ml</td>
                        </tr>
                    </tbody>
                </table>
                <p style="margin-top: 20px; font-style: italic; font-size: 12px">
                    Detección in vitro para la medición cuantitativa de hormona estimulante de la tiroides (TSH) en suero o plasma.<br>
                    leido e interpretado según especificaciones del fabricante.
                </p>
                <br>
                <div class="footer">
                    <p id="mensajeMedico" style="display: none;">El personal médico cuenta con un plazo de 24 a 48 horas para interpretar el reporte de los resultados.</p>
                    <p>Facebook: Veterinaria San Martin de Porres | Teléfono: 4000 - 1365 | Ext: 106</p>
                    <p>WhatsApp: 8839 - 2214 | San Rafael Abajo de Desamparados, 50 metros Norte del Mall Zona Centro</p>
                    <p>Correo: laboratorio@vetsanmartin.com</p>
                </div>
                    </div>
                </div>            
            </div>
        </div>
    </div>
    <div class="controls">
        <button id="pdfButton" onclick="generatePDF()">Generar PDF</button>
        <button id="menuButton" onclick="window.location.href='index.html'">Volver al Menú</button>
        <div id="loadingPdf" class="loading-indicator">
            <div class="spinner"></div>
            <span>Generando PDF...</span>
        </div>
    </div>
    <script>
                 // Función para actualizar la interpretación TSH basada en el valor
                 function actualizarInterpretacionTSH() {
                const resultadoInput = document.getElementById('tshResultado');
                const interpretacionSelect = document.getElementById('tshInterpretacion');
                
                // Obtener el valor actual y eliminar la unidad si ya existe
                let valorTexto = resultadoInput.value.replace(' ng/ml', '').trim();
                
                // Convertir valor (permitiendo tanto comas como puntos)
                let valor = valorTexto.replace(',', '.');
                
                // Convertir a número
                let valorNumerico = parseFloat(valor);
                
                // Actualizar interpretación según rangos
                if (!isNaN(valorNumerico)) {
                    // Formatear el valor con comas en lugar de puntos
                    let valorFormateado = valorNumerico.toFixed(2).replace('.', ',');
                    
                    // Añadir la unidad al valor
                    resultadoInput.value = valorFormateado + ' ng/ml';
                    
                    // Actualizar la interpretación según los rangos para TSH
                    if (valorNumerico < 0.5) {
                        interpretacionSelect.value = "Normal";
                    } else {
                        interpretacionSelect.value = "Alto";
                    }
                }
            }
          // Función para actualizar el signo y la interpretación del test de parvovirus
          function actualizarCpvSoloSigno(selectElement) {
                const signoCell = document.getElementById('cpvSoloSigno');
                const interpretacionCell = document.getElementById('cpvSoloInterpretacion');
                
                if (selectElement.value === 'Positivo') {
                    signoCell.textContent = '(+)';
                    interpretacionCell.textContent = 'Presencia de Antígeno de CPV';
                } else {
                    signoCell.textContent = '(-)';
                    interpretacionCell.textContent = 'Ausencia de Antígeno de CPV';
                }
            }
            
            // Función para previsualizar la imagen para test CPV solo
            function previewImageCPVSolo(event) {
                const reader = new FileReader();
                reader.onload = function() {
                    const output = document.getElementById('imagePreviewCPVSolo');
                    output.src = reader.result;
                    output.style.display = 'block';
                    document.getElementById('noImageTextCPVSolo').style.display = 'none';
                }
                reader.readAsDataURL(event.target.files[0]);
            }
        // Función para actualizar la interpretación T4 basada en el valor
        function actualizarInterpretacionT4() {
            const resultadoInput = document.getElementById('t4Resultado');
            const interpretacionSelect = document.getElementById('t4Interpretacion');
            
            // Obtener el valor actual y eliminar la unidad si ya existe
            let valorTexto = resultadoInput.value.replace(' ug/dl', '').trim();
            
            // Convertir valor (permitiendo tanto comas como puntos)
            let valor = valorTexto.replace(',', '.');
            
            // Convertir a número
            let valorNumerico = parseFloat(valor);
            
            // Actualizar interpretación según rangos
            if (!isNaN(valorNumerico)) {
                // Formatear el valor con comas en lugar de puntos
                let valorFormateado = valorNumerico.toFixed(2).replace('.', ',');
                
                // Añadir la unidad al valor
                resultadoInput.value = valorFormateado + ' ug/dl';
                
                // Actualizar la interpretación según los rangos para T4
                if (valorNumerico < 1.0) {
                    interpretacionSelect.value = "Bajo";
                } else if (valorNumerico >= 1.0 && valorNumerico <= 2.0) {
                    interpretacionSelect.value = "Bajo Normal";
                } else if (valorNumerico > 2.0 && valorNumerico <= 4.0) {
                    interpretacionSelect.value = "Normal";
                } else if (valorNumerico > 4.0) {
                    interpretacionSelect.value = "Alto";
                }
            }
        }

            // Función para actualizar el signo de FIV
            function actualizarFIVSigno(selectElement) {
            const signoCell = document.getElementById('fivSigno');
            if (selectElement.value === 'Positivo') {
                signoCell.textContent = '(+)';
            } else {
                signoCell.textContent = '(-)';
            }
        }
        
        // Función para actualizar el signo de FeLV
        function actualizarFeLVSigno(selectElement) {
            const signoCell = document.getElementById('felvSigno');
            if (selectElement.value === 'Positivo') {
                signoCell.textContent = '(+)';
            } else {
                signoCell.textContent = '(-)';
            }
        }
        
        // Función para previsualizar la imagen para FIV/FeLV
        function previewImageFIVFeLV(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const output = document.getElementById('imagePreviewFIVFeLV');
                output.src = reader.result;
                output.style.display = 'block';
                document.getElementById('noImageTextFIVFeLV').style.display = 'none';
            }
            reader.readAsDataURL(event.target.files[0]);
        }
        // Función para actualizar la interpretación SDMA basada en el valor
    function actualizarInterpretacionSDMA() {
        const resultadoInput = document.getElementById('sdmaResultado');
        const interpretacionSelect = document.getElementById('sdmaInterpretacion');
        
        // Obtener el valor actual y eliminar la unidad si ya existe
        let valorTexto = resultadoInput.value.replace(' ug/dl', '').trim();
        
        // Convertir valor (permitiendo tanto comas como puntos)
        let valor = valorTexto.replace(',', '.');
        
        // Convertir a número
        let valorNumerico = parseFloat(valor);
        
        // Actualizar interpretación según rangos
        if (!isNaN(valorNumerico)) {
            // Formatear el valor con comas en lugar de puntos
            let valorFormateado = valorNumerico.toFixed(2).replace('.', ',');
            
            // Añadir la unidad al valor
            resultadoInput.value = valorFormateado + ' ug/dl';
            
            // Actualizar la interpretación según los rangos para SDMA
            if (valorNumerico < 14) {
                interpretacionSelect.value = "Normal";
            } else if (valorNumerico >= 14.1 && valorNumerico <= 19.9) {
                interpretacionSelect.value = "Sospechoso";
            } else if (valorNumerico >= 20) {
                interpretacionSelect.value = "Enfermedad Renal Probable";
            }
        }
    }
    
           // Función para actualizar el signo de CPV en el test triple
    function actualizarTripleSignoCPV(selectElement) {
        const signoCell = document.getElementById('tripleSignoCPV');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    // Función para actualizar el signo de Giardia en el test triple
    function actualizarTripleSignoGiardia(selectElement) {
        const signoCell = document.getElementById('tripleSignoGiardia');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    // Función para actualizar el signo de CCV en el test triple
    function actualizarTripleSignoCCV(selectElement) {
        const signoCell = document.getElementById('tripleSignoCCV');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    // Función para previsualizar la imagen para el test triple
    function previewImageTripleTest(event) {
        const reader = new FileReader();
        reader.onload = function() {
            const output = document.getElementById('imagePreviewTripleTest');
            output.src = reader.result;
            output.style.display = 'block';
            document.getElementById('noImageTextTripleTest').style.display = 'none';
        }
        reader.readAsDataURL(event.target.files[0]);
    }
    function actualizarParvoGiardiaSignoCPV(selectElement) {
        const signoCell = document.getElementById('parvoGiardiaSignoCPV');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    function actualizarParvoGiardiaSignoGiardia(selectElement) {
        const signoCell = document.getElementById('parvoGiardiaSignoGiardia');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    function previewImageParvoGiardia(event) {
        const reader = new FileReader();
        reader.onload = function() {
            const output = document.getElementById('imagePreviewParvoGiardia');
            output.src = reader.result;
            output.style.display = 'block';
            document.getElementById('noImageTextParvoGiardia').style.display = 'none';
        }
        reader.readAsDataURL(event.target.files[0]);
    }
    function actualizarGiardiaSigno(selectElement) {
        const signoCell = document.getElementById('giardiaSigno');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    // Función para actualizar el signo de Cryptosporidium
    function actualizarCryptoSigno(selectElement) {
        const signoCell = document.getElementById('cryptoSigno');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    // Función para previsualizar la imagen para Giardia/Crypto
    function previewImageGiardiaCrypto(event) {
        const reader = new FileReader();
        reader.onload = function() {
            const output = document.getElementById('imagePreviewGiardiaCrypto');
            output.src = reader.result;
            output.style.display = 'block';
            document.getElementById('noImageTextGiardiaCrypto').style.display = 'none';
        }
        reader.readAsDataURL(event.target.files[0]);
    }
          // Función para actualizar la interpretación FPL basada en el valor
    function actualizarInterpretacionFPL() {
        const resultadoInput = document.getElementById('fplResultado');
        const interpretacionSelect = document.getElementById('fplInterpretacion');
        
        // Obtener el valor actual y eliminar la unidad si ya existe
        let valorTexto = resultadoInput.value.replace(' ng/ml', '').trim();
        
        // Convertir valor (permitiendo tanto comas como puntos)
        let valor = valorTexto.replace(',', '.');
        
        // Convertir a número
        let valorNumerico = parseFloat(valor);
        
        // Actualizar interpretación según rangos
        if (!isNaN(valorNumerico)) {
            // Formatear el valor con comas en lugar de puntos
            let valorFormateado = valorNumerico.toString().replace('.', ',');
            
            // Añadir la unidad al valor
            resultadoInput.value = valorFormateado + ' ng/ml';
            
            // Actualizar la interpretación según los rangos para FPL
            if (valorNumerico < 3.5) {
                interpretacionSelect.value = "Normal";
            } else if (valorNumerico >= 3.6 && valorNumerico <= 5.3) {
                interpretacionSelect.value = "Sospechoso";
            } else if (valorNumerico > 5.4) {
                interpretacionSelect.value = "Consistente con Pancreatitis";
            }
        }
    }
            function actualizarEhrlichiaCanisSigno(selectElement) {
        const signoCell = document.getElementById('ehrlichiaCanisSigno');
        if (selectElement.value === 'Positivo') {
            signoCell.textContent = '(+)';
        } else {
            signoCell.textContent = '(-)';
        }
    }
    
    // Función para previsualizar la imagen para Ehrlichia Canis
    function previewImageEhrlichiaCanis(event) {
        const reader = new FileReader();
        reader.onload = function() {
            const output = document.getElementById('imagePreviewEhrlichiaCanis');
            output.src = reader.result;
            output.style.display = 'block';
            document.getElementById('noImageTextEhrlichiaCanis').style.display = 'none';
        }
        reader.readAsDataURL(event.target.files[0]);
    }
         // Función para actualizar el signo de E. Canis
         function actualizarEcSigno(selectElement) {
            const signoCell = document.getElementById('ecSigno');
            if (selectElement.value === 'Positivo') {
                signoCell.textContent = '(+)';
            } else {
                signoCell.textContent = '(-)';
            }
        }
        
        // Función para actualizar el signo de Anaplasma
        function actualizarAnaplasmaSigno(selectElement) {
            const signoCell = document.getElementById('anaplasmaSigno');
            if (selectElement.value === 'Positivo') {
                signoCell.textContent = '(+)';
            } else {
                signoCell.textContent = '(-)';
            }
        }
        
        // Función para previsualizar la imagen para Ehrlichia-Anaplasma
        function previewImageEhrlichiaAnaplasma(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const output = document.getElementById('imagePreviewEhrlichiaAnaplasma');
                output.src = reader.result;
                output.style.display = 'block';
                document.getElementById('noImageTextEhrlichiaAnaplasma').style.display = 'none';
            }
            reader.readAsDataURL(event.target.files[0]);
        }
                function actualizarDistemperSigno(selectElement) {
            const signoCell = document.getElementById('distemperSigno');
            if (selectElement.value === 'Positivo') {
                signoCell.textContent = '(+)';
            } else {
                signoCell.textContent = '(-)';
            }
        }
        
        // Función para previsualizar la imagen para Distemper Test
        function previewImageDistemperTest(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const output = document.getElementById('imagePreviewDistemperTest');
                output.src = reader.result;
                output.style.display = 'block';
                document.getElementById('noImageTextDistemperTest').style.display = 'none';
            }
            reader.readAsDataURL(event.target.files[0]);
        }
                // Función para actualizar el texto de observación según el resultado seleccionado
                function formatResultSignCDV(selectElement) {
            const observacionCell = document.getElementById('cdvObservacion');
            if (selectElement.value === 'Positivo') {
                observacionCell.textContent = 'Presencia de antígeno CDV';
            } else {
                observacionCell.textContent = 'Ausencia de antígeno CDV';
            }
        }
        
        // Función para previsualizar la imagen para Distemper
        function previewImageDistemper(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const output = document.getElementById('imagePreviewDistemper');
                output.src = reader.result;
                output.style.display = 'block';
                document.getElementById('noImageTextDistemper').style.display = 'none';
            }
            reader.readAsDataURL(event.target.files[0]);
        }
           // Función para actualizar el signo de resultado en CPV
           function formatResultSignCPV(selectElement) {
            const observacionCell = selectElement.closest('tr').querySelector('td:last-child');
            if (selectElement.value === 'Positivo') {
                observacionCell.textContent = 'Presencia de antígeno CPV';
            } else {
                observacionCell.textContent = 'Ausencia de antígeno CPV';
            }
        }
        
        // Función para actualizar el signo de resultado en CCV
        function formatResultSignCCV(selectElement) {
            const observacionCell = selectElement.closest('tr').querySelector('td:last-child');
            if (selectElement.value === 'Positivo') {
                observacionCell.textContent = 'Presencia de antígeno CCV';
            } else {
                observacionCell.textContent = 'Ausencia de antígeno CCV';
            }
        }
        
        // Función para previsualizar la imagen para CPV+CCV
        function previewImageCPVCCV(event) {
            const reader = new FileReader();
            reader.onload = function() {
                const output = document.getElementById('imagePreviewCPVCCV');
                output.src = reader.result;
                output.style.display = 'block';
                document.getElementById('noImageTextCPVCCV').style.display = 'none';
            }
            reader.readAsDataURL(event.target.files[0]);
        }
       // Función para actualizar la interpretación basada en el valor
function actualizarInterpretacionCPL() {
    const resultadoInput = document.getElementById('cplResultado');
    const interpretacionSelect = document.getElementById('cplInterpretacion');
    
    // Obtener el valor actual y eliminar la unidad si ya existe
    let valorTexto = resultadoInput.value.replace(' ng/mL', '').trim();
    
    // Convertir valor (permitiendo tanto comas como puntos)
    let valor = valorTexto.replace(',', '.');
    
    // Convertir a número
    let valorNumerico = parseFloat(valor);
    
    // Actualizar interpretación según rangos
    if (!isNaN(valorNumerico)) {
        // Formatear el valor con comas en lugar de puntos
        let valorFormateado = valorNumerico.toString().replace('.', ',');
        
        // Añadir la unidad al valor
        resultadoInput.value = valorFormateado + ' ng/mL';
        
        // Actualizar la interpretación
        if (valorNumerico < 200) {
            interpretacionSelect.value = "Normal";
        } else if (valorNumerico >= 200 && valorNumerico <= 400) {
            interpretacionSelect.value = "Sospechoso";
        } else if (valorNumerico > 400) {
            interpretacionSelect.value = "Consistente con Pancreatitis";
        }
    }
}
            function formatResultSign(selectElement) {
            const signColumn = selectElement.closest('tr').querySelector('.sign-column');
            signColumn.textContent = selectElement.value === 'Positivo' ? '+' : '-';
        }
            function actualizarSexoEnPlantilla() {
            const sexo = document.getElementById('sexoSelector').value;
            document.getElementById('sexoEnPlantilla').value = sexo.charAt(0).toUpperCase() + sexo.slice(1);
        }
        
        // Función para actualizar la especie en la plantilla
        function actualizarEspecieEnPlantilla() {
            const especie = document.getElementById('especieSelector').value;
            document.getElementById('especieEnPlantilla').value = especie;
            
            // Actualizar las razas disponibles según la especie
            actualizarRazasPorEspecie();
        }
        
        // Función para verificar médico (si es necesaria)
        function verificarMedico() {
            const medico = document.getElementById('nombreMedico').value;
            const mensaje = document.getElementById('mensajeMedico');
            if (mensaje) {
                // Verificar si el médico es N.A en cualquier variante o está vacío
                const isNA = !medico || 
                           medico.trim() === '' || 
                           medico.toUpperCase() === 'N.A' || 
                           medico.toUpperCase() === 'NA' || 
                           medico.toUpperCase() === 'N.A.';
                
                if (isNA) {
                    mensaje.style.display = 'none';
                } else {
                    mensaje.style.display = 'block';
                }
            }
        }
        
        function mostrarPlantillaSeleccionada() {
    const valor = document.getElementById('templateSelector').value;

    // Ocultar todas las plantillas
    const plantillas = document.querySelectorAll('.plantilla');
    plantillas.forEach(plantilla => {
        plantilla.style.display = 'none';
    });

    // Mostrar y mover la plantilla seleccionada
    if (valor) {
        const plantillaSeleccionada = document.getElementById(valor);
        if (plantillaSeleccionada) {
            plantillaSeleccionada.style.display = 'block';

            // Mover la plantilla seleccionada justo debajo de #datosBasicos
            const contenedorPrincipal = document.querySelector('.a4-container');
            const datosBasicos = document.getElementById('datosBasicos');
            contenedorPrincipal.insertBefore(plantillaSeleccionada, datosBasicos.nextSibling);
        } else {
            console.error("No se encontró la plantilla:", valor);
        }
    }
}
        
        // Función para mover el foco con flechas
        function moverFocoConFlechas(event, derechaId, izquierdaId, arribaId, abajoId) {
            switch (event.key) {
                case 'ArrowRight':
                    event.preventDefault();
                    document.getElementById(derechaId).focus();
                    break;
                case 'ArrowLeft':
                    event.preventDefault();
                    document.getElementById(izquierdaId).focus();
                    break;
                case 'ArrowUp':
                    event.preventDefault();
                    document.getElementById(arribaId).focus();
                    break;
                case 'Enter':
                case 'ArrowDown':
                    event.preventDefault();
                    document.getElementById(abajoId).focus();
                    break;
            }
        }
        
        // Base de datos de razas caninas
        const razasCaninas = [
            "Ainu", "Airedale terrier", "Akita", "Akita Inu", "Alaskan Malamute",
            "American Black and Tan Coonhound", "American Bull Terrier", "American Pit Bull Terrier",
            "American Staffordshire terrier", "American Water Spaniel", "Apso Tibetano", "Barzoi", 
            "Basenji", "Basset Hound", "Beagle", "Bichon Frise", "Bloodhound", "Bobtail", 
            "Border Collie", "Boston Terrier", "Bouvier des Flandres", "Boxer", "Bull terrier", 
            "Bull Terrier Miniatura", "Bulldog Americano", "Bulldog Francés", "Bulldog Inglés", 
            "Bullmastiff", "Cavalier King Charles Spaniel", "Chihuahua", "Chow Chow", 
            "Cocker Spaniel Americano", "Cocker Spaniel Inglés", "Collie", "Collie Escocés", 
            "Dachshund", "Dálmata", "Doberman", "Doberman Pincher", "Dogo Alemán", 
            "Dogo Argentino", "Dogo de Burdeos", "French Poodle", "Galgo Español", 
            "Galgo Inglés-español", "Golden Retriever", "Gran Danés", "Greyhound", 
            "Husky Siberiano", "Jack Russell Terrier", "Labrador Retriever", "Maltés", 
            "Pastor Alemán", "Pequinés", "Pomerania", "Pug", "Rottweiler", "Samoyedo", 
            "San Bernardo", "Schnauzer", "Shih Tzu", "SRD", "Yorkshire Terrier", "Weimaraner", "Fila Brasileiro"
        ];

        // Base de datos de razas felinas
        const razasFelinas = [
            "Abisinio", "American Bobtail", "Angora Turco", "Azul Ruso", "Balinés", 
            "Bengalí", "Bobtail japonés", "Bombay", "British Shorthair", "Burmés", 
            "Carey", "Común Europeo", "Exótico", "Himalayo", "Javanés", 
            "Oriental", "Persa", "Sagrado de Birmania", "Siamés", "Siberiano", 
            "Silvestre", "SRD"
        ];

        // Función para actualizar el datalist de razas según la especie seleccionada
        function actualizarRazasPorEspecie() {
            const especie = document.getElementById('especieSelector').value;
            // Crear el datalist si no existe
            let datalistRazas = document.getElementById('razas');
            if (!datalistRazas) {
                datalistRazas = document.createElement('datalist');
                datalistRazas.id = 'razas';
                document.body.appendChild(datalistRazas);
            } else {
                // Limpiar la lista actual
                datalistRazas.innerHTML = '';
            }
            
            const campoRaza = document.getElementById('mascotaRaza');
            
            // Restablecer el campo de raza si se cambia la especie
            if (campoRaza.value && campoRaza.value !== "SRD") {
                campoRaza.value = '';
            }
            
            // Agregar las razas según la especie seleccionada
            if (especie === "Canino") {
                razasCaninas.forEach(raza => {
                    const option = document.createElement('option');
                    option.value = raza;
                    datalistRazas.appendChild(option);
                });
            } else if (especie === "Felino") {
                razasFelinas.forEach(raza => {
                    const option = document.createElement('option');
                    option.value = raza;
                    datalistRazas.appendChild(option);
                });
            } else if (especie === "Lagomorfo" || especie === "Cuilo") {
                // Para otras especies, agregar solo opciones genéricas
                const option = document.createElement('option');
                option.value = "SRD";
                datalistRazas.appendChild(option);
            }
        }

        // Ejecutar al cargar la página
        document.addEventListener('DOMContentLoaded', function() {
            // Asegurarse de que existe el selector de especies
            const especieSelector = document.getElementById('especieSelector');
            if (especieSelector) {
                // Si ya hay una especie seleccionada al cargar
                if (especieSelector.value !== "Seleccionar") {
                    actualizarRazasPorEspecie();
                }
                
                // Agregar un listener adicional para garantizar que se actualicen las razas
                especieSelector.addEventListener('change', actualizarRazasPorEspecie);
            }
            
            // Crear datalist si no existe
            if (!document.getElementById('razas')) {
                const datalist = document.createElement('datalist');
                datalist.id = 'razas';
                document.body.appendChild(datalist);
            }
        });
    function previewImage(event) {
        const reader = new FileReader();
        reader.onload = function() {
            const output = document.getElementById('imagePreview');
            output.src = reader.result;
            output.style.display = 'block';
            document.getElementById('noImageText').style.display = 'none';
        }
        reader.readAsDataURL(event.target.files[0]);
    }
    async function generatePDF() {
    // Mostrar el indicador de carga
    const loadingIndicator = document.getElementById('loadingPdf');
    const pdfButton = document.getElementById('pdfButton');
    
    loadingIndicator.style.display = 'flex';
    pdfButton.disabled = true;
    
    try {
        const { jsPDF } = window.jspdf;
        
        // Obtener el template seleccionado basado en el selector
        const templateSelector = document.getElementById('templateSelector');
        const selectedTemplateId = templateSelector.value;
        
        if (!selectedTemplateId) {
            alert('Por favor, selecciona un tipo de prueba primero.');
            return;
        }
        
        const selectedTemplate = document.getElementById(selectedTemplateId);
        if (!selectedTemplate) {
            alert('No se encontró la plantilla seleccionada.');
            return;
        }

        // Obtener el nombre de la mascota y el propietario para el nombre del archivo
        const mascotaNombre = document.getElementById('mascotaNombre').value || 'Sin_nombre';
        const propietarioNombre = document.getElementById('propietarioNombre').value || 'Sin_apellido';
        
        // Extraer el primer apellido (segundo elemento después de dividir por espacios)
        const nombreArray = propietarioNombre.split(' ');
        const propietarioApellido = nombreArray.length > 1 ? nombreArray[1] : nombreArray[0];
        
        // Obtener el nombre del test seleccionado para el nombre del archivo
        const testName = templateSelector.options[templateSelector.selectedIndex].text;

        // Asegurarse de que las imágenes estén cargadas
        const images = selectedTemplate.getElementsByTagName('img');
        const loadImages = Array.from(images).map(img => {
            return new Promise((resolve, reject) => {
                if (img.complete) {
                    resolve();
                } else {
                    img.onload = resolve;
                    img.onerror = resolve; // Continuar incluso si hay error en alguna imagen
                }
            });
        });

        await Promise.all(loadImages);

        // Hacer visible solo el template seleccionado para la captura
        const allTemplates = document.querySelectorAll('.plantilla');
        allTemplates.forEach(template => {
            template.style.display = 'none';
        });
        
        // Hacer visible el template y los datos básicos para la captura
        const datosBasicos = document.getElementById('datosBasicos');
        if (datosBasicos) datosBasicos.style.display = 'block';
        selectedTemplate.style.display = 'block';

        // *** OCULTAR SOLO LOS CONTROLES DE CARGA DE IMAGEN, NO LAS IMÁGENES ***
        const fileInputs = selectedTemplate.querySelectorAll('input[type="file"]');
        const uploadButtons = selectedTemplate.querySelectorAll('.image-upload-container button');
        
        // Guardar el estado original de visibilidad para restaurar después
        const inputsDisplayStyle = [];
        const buttonsDisplayStyle = [];
        
        // Ocultar los elementos de entrada
        fileInputs.forEach((input, index) => {
            inputsDisplayStyle[index] = input.style.display;
            input.style.display = 'none';
        });
        
        // Ocultar los botones
        uploadButtons.forEach((button, index) => {
            buttonsDisplayStyle[index] = button.style.display;
            button.style.display = 'none';
        });
        
        // Ocultar los textos "Sin imagen" si hay una imagen cargada
        const noImageTexts = selectedTemplate.querySelectorAll('[id^="noImageText"]');
        noImageTexts.forEach(text => {
            // Si hay una imagen mostrada, ocultar el texto "Sin imagen"
            const imageContainer = text.parentElement;
            const image = imageContainer.querySelector('img');
            if (image && image.style.display !== 'none' && image.src && image.src !== '#') {
                text.style.display = 'none';
            }
        });

      // Generar el canvas
        const captureElement = document.querySelector('.a4-container');
        const canvas = await html2canvas(captureElement, {
            scale: 2,
            useCORS: true,
            logging: false,
            allowTaint: true,
            backgroundColor: '#ffffff'
        });

        const imgData = canvas.toDataURL('image/jpeg', 1.0);
        const pdf = new jsPDF('p', 'mm', 'a4');

        // Configuración mejorada para el tamaño y posición
        const pageWidth = 210; // Ancho de página A4 en mm
        const pageHeight = 297; // Alto de página A4 en mm

        // Reducir el ancho de la imagen para tener más margen
        const imgWidth = 170; // En lugar de 140 o 210
        const imgHeight = (canvas.height * imgWidth) / canvas.width;

        // Calcular los márgenes para centrar la imagen
        const marginLeft = (pageWidth - imgWidth) / 2;
        const marginTop = 10; // Margen superior de 10mm

        // Agregar la imagen al PDF con los márgenes calculados
        pdf.addImage(imgData, 'JPEG', marginLeft, marginTop, imgWidth, imgHeight);

        // Generar nombre de archivo
        const fileName = `${testName} ${mascotaNombre} ${propietarioApellido}.pdf`;
        
        // NUEVO: Usar File System Access API si está disponible
        if ('showSaveFilePicker' in window) {
            try {
                const fileHandle = await window.showSaveFilePicker({
                    suggestedName: fileName,
                    types: [{
                        description: 'PDF Document',
                        accept: {'application/pdf': ['.pdf']},
                    }],
                });
                
                // Convertir el PDF a Blob
                const pdfBlob = pdf.output('blob');
                
                // Escribir en el archivo
                const writableStream = await fileHandle.createWritable();
                await writableStream.write(pdfBlob);
                await writableStream.close();
                
                console.log('Archivo guardado con éxito usando File System Access API');
            } catch (err) {
                console.error('Error o cancelación al usar File System Access API:', err);
                // Si hay un error (o el usuario cancela), usar el método tradicional
                pdf.save(fileName);
            }
        } else {
            // Navegador no compatible con File System Access API
            console.log('Navegador no compatible con File System Access API, usando método tradicional');
            pdf.save(fileName);
        }
        
        // *** RESTAURAR LA VISIBILIDAD DE LOS CONTROLES DE CARGA ***
        fileInputs.forEach((input, index) => {
            input.style.display = inputsDisplayStyle[index];
        });
        
        uploadButtons.forEach((button, index) => {
            button.style.display = buttonsDisplayStyle[index];
        });
        
        // Restaurar la visualización normal después de generar el PDF
        mostrarPlantillaSeleccionada();
        
    } catch (error) {
        console.error('Error al generar el PDF:', error);
        alert('Ocurrió un error al generar el PDF: ' + error.message);
    } finally {
        // Ocultar el indicador de carga y habilitar el botón nuevamente
        loadingIndicator.style.display = 'none';
        pdfButton.disabled = false;
    }
}
    </script>
</body>
</html>